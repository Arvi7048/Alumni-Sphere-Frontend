{"ast":null,"code":"import React,{useState}from\"react\";import Modal from\"./Modal\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const TwoFactorAuthModal=_ref=>{let{open,onClose,enabled,onStatusChange}=_ref;const[step,setStep]=useState(\"init\");// init | verify | success\nconst[code,setCode]=useState(\"\");const[loading,setLoading]=useState(false);const[error,setError]=useState(\"\");const[success,setSuccess]=useState(\"\");const handleSetup=async()=>{setLoading(true);setError(\"\");try{const res=await axios.post(\"/api/users/2fa/setup\");if(res.data&&res.data.secret){setStep(\"verify\");}else{setError(\"Failed to generate 2FA secret.\");}}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||\"Failed to start 2FA setup.\");}finally{setLoading(false);}};const handleVerify=async()=>{setLoading(true);setError(\"\");try{await axios.post(\"/api/users/2fa/verify\",{code});setSuccess(\"Two-factor authentication enabled!\");onStatusChange(true);setStep(\"success\");}catch(err){setError(\"Invalid code. Please try again.\");}finally{setLoading(false);}};const handleDisable=async()=>{setLoading(true);setError(\"\");try{await axios.post(\"/api/users/2fa/disable\");setSuccess(\"Two-factor authentication disabled.\");onStatusChange(false);setStep(\"init\");}catch(err){setError(\"Failed to disable 2FA.\");}finally{setLoading(false);}};return/*#__PURE__*/_jsx(Modal,{open:open,onClose:onClose,title:\"Two-Factor Authentication\",children:/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:enabled?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Two-factor authentication is currently \",/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 font-semibold\",children:\"enabled\"}),\" on your account.\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-danger\",onClick:handleDisable,disabled:loading,children:loading?\"Disabling...\":\"Disable 2FA\"}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"text-green-600 text-sm\",children:success}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-red-600 text-sm\",children:error})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[step===\"init\"&&/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:handleSetup,disabled:loading,children:loading?\"Starting...\":\"Start 2FA Setup\"}),step===\"verify\"&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>{e.preventDefault();handleVerify();},className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium mb-1\",children:\"Enter the 2FA code sent to your email or authenticator app:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:code,onChange:e=>setCode(e.target.value),className:\"input-field w-full\",required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:loading,children:loading?\"Verifying...\":\"Verify & Enable\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-red-600 text-sm\",children:error})]}),step===\"success\"&&/*#__PURE__*/_jsx(\"div\",{className:\"text-green-600\",children:\"Two-factor authentication enabled!\"})]})})});};export default TwoFactorAuthModal;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}