{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\arvin\\\\OneDrive\\\\Desktop\\\\project2\\\\alumni-verse\\\\frontend\\\\src\\\\components\\\\TwoFactorAuthModal.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport Modal from \"./Modal\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst TwoFactorAuthModal = ({\n  open,\n  onClose,\n  enabled,\n  onStatusChange\n}) => {\n  _s();\n  const [step, setStep] = useState(\"init\"); // init | verify | success\n  const [code, setCode] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [success, setSuccess] = useState(\"\");\n  const handleSetup = async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const res = await axios.post(\"/api/users/2fa/setup\");\n      if (res.data && res.data.secret) {\n        setStep(\"verify\");\n      } else {\n        setError(\"Failed to generate 2FA secret.\");\n      }\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Failed to start 2FA setup.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleVerify = async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      await axios.post(\"/api/users/2fa/verify\", {\n        code\n      });\n      setSuccess(\"Two-factor authentication enabled!\");\n      onStatusChange(true);\n      setStep(\"success\");\n    } catch (err) {\n      setError(\"Invalid code. Please try again.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleDisable = async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      await axios.post(\"/api/users/2fa/disable\");\n      setSuccess(\"Two-factor authentication disabled.\");\n      onStatusChange(false);\n      setStep(\"init\");\n    } catch (err) {\n      setError(\"Failed to disable 2FA.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    open: open,\n    onClose: onClose,\n    title: \"Two-Factor Authentication\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: enabled ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Two-factor authentication is currently \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-green-600 font-semibold\",\n            children: \"enabled\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 55\n          }, this), \" on your account.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-danger\",\n          onClick: handleDisable,\n          disabled: loading,\n          children: loading ? \"Disabling...\" : \"Disable 2FA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 13\n        }, this), success && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-green-600 text-sm\",\n          children: success\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 25\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-600 text-sm\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 23\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [step === \"init\" && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-primary\",\n          onClick: handleSetup,\n          disabled: loading,\n          children: loading ? \"Starting...\" : \"Start 2FA Setup\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 15\n        }, this), step === \"verify\" && /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: e => {\n            e.preventDefault();\n            handleVerify();\n          },\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium mb-1\",\n              children: \"Enter the 2FA code sent to your email or authenticator app:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: code,\n              onChange: e => setCode(e.target.value),\n              className: \"input-field w-full\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"btn-primary\",\n            disabled: loading,\n            children: loading ? \"Verifying...\" : \"Verify & Enable\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 17\n          }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-red-600 text-sm\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 27\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 15\n        }, this), step === \"success\" && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-green-600\",\n          children: \"Two-factor authentication enabled!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n};\n_s(TwoFactorAuthModal, \"NLcayyShvdNMRhboVVq+ruL58ho=\");\n_c = TwoFactorAuthModal;\nexport default TwoFactorAuthModal;\nvar _c;\n$RefreshReg$(_c, \"TwoFactorAuthModal\");","map":{"version":3,"names":["React","useState","Modal","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","TwoFactorAuthModal","open","onClose","enabled","onStatusChange","_s","step","setStep","code","setCode","loading","setLoading","error","setError","success","setSuccess","handleSetup","res","post","data","secret","err","_err$response","_err$response$data","response","message","handleVerify","handleDisable","title","children","className","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","onSubmit","e","preventDefault","type","value","onChange","target","required","_c","$RefreshReg$"],"sources":["C:/Users/arvin/OneDrive/Desktop/project2/alumni-verse/frontend/src/components/TwoFactorAuthModal.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport Modal from \"./Modal\";\nimport axios from \"axios\";\n\nconst TwoFactorAuthModal = ({ open, onClose, enabled, onStatusChange }) => {\n  const [step, setStep] = useState(\"init\"); // init | verify | success\n  const [code, setCode] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [success, setSuccess] = useState(\"\");\n\n  const handleSetup = async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const res = await axios.post(\"/api/users/2fa/setup\");\n      if (res.data && res.data.secret) {\n        setStep(\"verify\");\n      } else {\n        setError(\"Failed to generate 2FA secret.\");\n      }\n    } catch (err) {\n      setError(err.response?.data?.message || \"Failed to start 2FA setup.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleVerify = async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      await axios.post(\"/api/users/2fa/verify\", { code });\n      setSuccess(\"Two-factor authentication enabled!\");\n      onStatusChange(true);\n      setStep(\"success\");\n    } catch (err) {\n      setError(\"Invalid code. Please try again.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDisable = async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      await axios.post(\"/api/users/2fa/disable\");\n      setSuccess(\"Two-factor authentication disabled.\");\n      onStatusChange(false);\n      setStep(\"init\");\n    } catch (err) {\n      setError(\"Failed to disable 2FA.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Modal open={open} onClose={onClose} title=\"Two-Factor Authentication\">\n      <div className=\"space-y-4\">\n        {enabled ? (\n          <>\n            <p>Two-factor authentication is currently <span className=\"text-green-600 font-semibold\">enabled</span> on your account.</p>\n            <button className=\"btn-danger\" onClick={handleDisable} disabled={loading}>\n              {loading ? \"Disabling...\" : \"Disable 2FA\"}\n            </button>\n            {success && <div className=\"text-green-600 text-sm\">{success}</div>}\n            {error && <div className=\"text-red-600 text-sm\">{error}</div>}\n          </>\n        ) : (\n          <>\n            {step === \"init\" && (\n              <button className=\"btn-primary\" onClick={handleSetup} disabled={loading}>\n                {loading ? \"Starting...\" : \"Start 2FA Setup\"}\n              </button>\n            )}\n            {step === \"verify\" && (\n              <form onSubmit={e => { e.preventDefault(); handleVerify(); }} className=\"space-y-2\">\n                <div>\n                  <label className=\"block text-sm font-medium mb-1\">Enter the 2FA code sent to your email or authenticator app:</label>\n                  <input\n                    type=\"text\"\n                    value={code}\n                    onChange={e => setCode(e.target.value)}\n                    className=\"input-field w-full\"\n                    required\n                  />\n                </div>\n                <button type=\"submit\" className=\"btn-primary\" disabled={loading}>\n                  {loading ? \"Verifying...\" : \"Verify & Enable\"}\n                </button>\n                {error && <div className=\"text-red-600 text-sm\">{error}</div>}\n              </form>\n            )}\n            {step === \"success\" && (\n              <div className=\"text-green-600\">Two-factor authentication enabled!</div>\n            )}\n          </>\n        )}\n      </div>\n    </Modal>\n  );\n};\n\nexport default TwoFactorAuthModal;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}